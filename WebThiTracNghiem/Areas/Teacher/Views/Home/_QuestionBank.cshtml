@model IEnumerable<CauHoi>

<div class="main-content">
	<div class="question-page">
		<h1>Ngân hàng câu hỏi</h1>
		<div class="header-actions">
			<form id="import-form" enctype="multipart/form-data">
				<label for="qbexam-file" class="btn secondary">
					<i class="fas fa-file-import"></i> Nhập từ file
				</label>
				<input type="file" id="qbexam-file" name="examFile" accept=".doc,.docx,.pdf" style="display:none" />
			</form>
			<!-- Modal hiển thị câu hỏi sau khi import -->
			<div id="qb-question-modal" style="display:none;">
				<div class="modal-content">
					<h3>Danh sách câu hỏi được import</h3>
					<div id="modal-question-list"></div>
					<div class="modal-actions">
						<button id="qb-modal-accept-btn" class="btn primary">Lưu vào ngân hàng</button>
						<button id="qb-modal-cancel-btn" class="btn secondary">Hủy</button>
					</div>
				</div>
			</div>

			<div id="loading-overlay" style="display:none;">
				<div class="loading-box">
					<div class="spinner"></div>
					<p>Đang xử lý file...</p>
				</div>
			</div>


			<a asp-controller="QuestionBank" asp-action="Create" class="btn primary AddQuestion">
				<i class="fas fa-plus"></i> Thêm câu hỏi mới
			</a>
		</div>
	</div>

	<div class="questionbank-section" style="background:#fff;border-radius:12px;box-shadow:0 2px 12px rgba(25,118,210,0.08);padding:2.5rem 2rem;max-width:1200px;margin:2rem auto;">

		<!-- Bộ lọc -->
		<div class="filters-section">
			<div class="filter-group">
				<label for="subject">Chủ đề:</label>
				<select id="questionTopic">
					@{
						var cds = ViewData["ChuDes"] as List<ChuDe>;
					}
					<option value="0">Tất cả chủ đề</option>
					@foreach (var cd in cds)
					{
						<option value="@cd.Id">@cd.TenCD</option>
					}
				</select>
			</div>
		</div>

		<div class="questions-list">
			@{
				var chuDeId = ViewBag.ChuDeId;
			}

			<div class="pagination">
				<button class="btn-page btn-qb" @(ViewBag.CurrentPage == 1 ? "disabled" : "") href="/teacher/home/LoadQuestionByTopic?ChuDeId=@chuDeId&page=1">
					<i class="fas fa-chevron-left"></i>
				</button>

				@for (int i = 1; i <= ViewBag.TotalPages; i++)
				{
					<button class="btn-page btn-qb @(ViewBag.CurrentPage == i ? "active" : "")" href="/teacher/home/LoadQuestionByTopic?ChuDeId=@chuDeId&page=@i">@i</button>
				}

				<button class="btn-page btn-qb" @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "") href="/teacher/home/LoadQuestionByTopic?ChuDeId=@chuDeId&page=@ViewBag.TotalPages">
					<i class="fas fa-chevron-right"></i>
				</button>
			</div>
			@foreach (var ch in Model)
			{
				<div class="question-card">
					<div class="question-header">
						<span class="question-type">@(ch.Loai == "TracNghiem" ? "Trắc nghiệm" : "Nhiều đáp án")</span>
						<div class="question-actions">
							<a asp-action="Edit" asp-route-id="@ch.Id" class="btn-icon"><i class="fas fa-edit"></i></a>
							<a asp-action="Delete" asp-route-id="@ch.Id" class="btn-icon danger"><i class="fas fa-trash"></i></a>
						</div>
					</div>
					<div class="question-content">
						<p class="question-text">@ch.NoiDung</p>
						<div class="answer-options">
							@foreach (var da in ch.DapAnList)
							{
								<div class="answer-option @(da.DungSai ? "correct" : "")">
									<span class="option-label">@da.Id</span>
									<span class="option-text">@da.NoiDung</span>
								</div>
							}
						</div>
					</div>
				</div>
			}
			<div class="pagination">
				<button class="btn-page btn-qb" @(ViewBag.CurrentPage == 1 ? "disabled" : "") href="/teacher/home/LoadQuestionByTopic?ChuDeId=@ViewBag.ChuDeId&page=1">
					<i class="fas fa-chevron-left"></i>
				</button>

				@for (int i = 1; i <= ViewBag.TotalPages; i++)
				{
					<button class="btn-page btn-qb @(ViewBag.CurrentPage == i ? "active" : "")" href="/teacher/home/LoadQuestionByTopic?ChuDeId=@ViewBag.ChuDeId&page=@i">@i</button>
				}

				<button class="btn-page btn-qb" @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "") href="/teacher/home/LoadQuestionByTopic?ChuDeId=@ViewBag.ChuDeId&page=@ViewBag.TotalPages">
					<i class="fas fa-chevron-right"></i>
				</button>
			</div>
		</div>

	</div>
</div>
